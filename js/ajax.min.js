function ajax(t){"object"!=typeof t&&(t={});let e,o="function",n="undefined";typeof XMLHttpRequest!==n?e=new XMLHttpRequest:(window.ActiveXObject,["MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"].forEach(t=>{e=new ActiveXObject(t)}));let a=typeof t.onfailure==o;if(!e)return a&&t.onfailure(0,""),!1;let s=typeof t.onprogress==o&&e.upload;s&&e.upload.addEventListener("progress",e=>{t.onprogress(Math.floor(e.loaded/e.total*100))}),e.onreadystatechange=function(){4==e.readyState&&(200==e.status?(s&&t.onprogress(!1),"function"==typeof t.onsuccess&&t.onsuccess(e.responseText,e.status,e.statusText)):a&&t.onfailure(e.status,e.statusText))},e.open(t.method||"GET",t.url||location.pathname),t.ContentType&&(typeof FormData!=n&&t.data instanceof FormData||e.setRequestHeader("Content-Type",t.contentType)),e.send(t.data||null)}